---
layout: default
title: OpenSquat
parent: Cyber Threat Intelligence
nav_order: 1
---
# OpenSquat

What: #tool\
Where: #github\
Who: Andre Tenreiro\
When: since 11/10/2020\
How: [video]
{: .fs-3 .ls-10 .text-mono .code-example }

–°–µ–≥–æ–¥–Ω—è—à–Ω–∏–π –≥–æ—Å—Ç—å - —É—Ç–∏–ª–∏—Ç–∞ OpenSquat, –∫–æ—Ç–æ—Ä–∞—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–æ–∏—Å–∫–∞ –≤ —Å–ø–∏—Å–∫–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–æ–º–µ–Ω–æ–≤ –∏–º—ë–Ω –ø–æ—Ö–æ–∂–∏—Ö –Ω–∞ –¥–æ–º–µ–Ω –≤–∞—à–µ–π –∫–æ–º–ø–∞–Ω–∏–∏. –°–≤–æ–µ–≥–æ —Ä–æ–¥–∞ –ø—Ä–µ–≤–µ–Ω—Ç–∏–≤–Ω–∞—è –∑–∞—â–∏—Ç–∞ –æ—Ç —Ñ–∏—à–∏–Ω–≥–æ–≤—ã—Ö –∞—Ç–∞–∫, –æ–º–æ–≥—Ä–∞—Ñ–æ–≤ IDN, [–±–∏—Ç]-  –∏ [—Ç–∞–π–ø]-—Å–∫–≤–æ—Ç—Ç–∏–Ω–≥–∞, —Ç–∞–∫–∂–µ –≤ —Å–ø–∏—Å–∫–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π –¥–∞–Ω–Ω–æ–π —É—Ç–∏–ª–∏—Ç—ã –µ—Å—Ç—å –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –æ—Ç–∫—Ä—ã—Ç—ã–µ 80/TCP –∏ 443/TCP, –∞ –≤ —Ä–∞–±–æ—Ç–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ñ–æ—Ä–º—É–ª—ã –≤—ã—á–∏—Å–ª–µ–Ω–∏—è [—Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è –õ–µ–≤–µ–Ω—à—Ç–µ–π–Ω–∞] (—Å–æ–≤–µ—Ç—Å–∫–∏–π –∏ —Ä–æ—Å—Å–∏–π—Å–∫–∏–π –º–∞—Ç–µ–º–∞—Ç–∏–∫) –∏ [—Å—Ö–æ–¥—Å—Ç–≤–æ –î–∂–∞—Ä–æ-–í–∏–Ω–∫–ª–µ—Ä–∞].

–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –ø–æ–¥—Ç—è–≥–∏–≤–∞–µ—Ç –º–∞—Å—Å–∏–≤ –∏–∑ –¥–æ–º–µ–Ω–Ω—ã—Ö –∏–º—ë–Ω —Å [—Å–∞–π—Ç–∞], –Ω–æ –º–Ω–µ –ø–æ–∫–∞–∑–∞–ª–æ—Å—å, —á—Ç–æ —Ç–∞–º –Ω–µ–¥–æ—Å—Ç–∞—ë—Ç –∑–æ–Ω—ã .ru. –ü–æ—ç—Ç–æ–º—É –±—ã–ª–æ –ø—Ä–∏–Ω—è—Ç–æ —Ä–µ—à–µ–Ω–∏–µ –Ω–µ–º–Ω–æ–≥–æ –ø–æ–º–µ–Ω—è—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª, –∑–∞–º–µ–Ω–∏–≤ "—Ä–æ–¥–Ω—É—é" —Å—Å—ã–ª–∫—É –Ω–∞:

```markdown
self.URL = ("https://domains-monitor.com/api/v1/$TOKEN/get/dailyupdate/list/text/")
```

–¢–æ–∫–µ–Ω API –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å, –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–≤—à–∏—Å—å –Ω–∞ —Å–∞–π—Ç–µ domains-monitor.com, –≤—Ä–µ–º–µ–Ω–Ω–æ–π –∏–Ω—Ç–µ—Ä–≤–∞–ª –≤—ã–≥—Ä—É–∑–∫–∏ –∏ –µ—ë —Ñ–æ—Ä–º–∞—Ç –≤—ã–±—Ä–∞—Ç—å –ø–æ —Å–≤–æ–µ–º—É —É—Å–º–æ—Ç—Ä–µ–Ω–∏—é.
–ü–æ –∏—Ç–æ–≥–∞–º, –º—ã –≤–µ–¥—ë–º –ø–æ–∏—Å–∫ –ø–æ 1,5–∫+ –∑–æ–Ω–∞–º, –≤–∫–ª—é—á–∞—è —Å–æ–≤—Å–µ–º —É–∂ —Ä–µ–¥–∫–∏–µ.

–î–∞–ª–µ–µ, –µ—Å—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –∑–∞–ø—Ä–æ—Å—ã –∫ VT, –¥–∞–±—ã –ø—Ä–æ–≤–µ—Ä—è—Ç—å —Ä–µ–ø—É—Ç–∞—Ü–∏—é –¥–æ–º–µ–Ω–Ω–æ–≥–æ –∏–º–µ–Ω–∏, –æ–¥–Ω–∞–∫–æ, –ø–æ –¥–µ—Ñ–æ–ª—Ç—É, –æ–±—Ä–∞—â–∞—è—Å—å –∫ https://www.virustotal.com/ui/domain/ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –±—É–¥–µ—Ç –æ–¥–∏–Ω:

```markdown
{'error': {'code': 'NotFoundError', 'message': 'Resource not found.'}}
```

–≤ –æ—Ç–≤–µ—Ç –Ω–∞ –∑–∞–ø—Ä–æ—Å –ª—é–±–æ–≥–æ –¥–æ–º–µ–Ω–∞, –Ω–µ –≤–∞–∂–Ω–æ –∫–∞–∫–∞—è —É —Ç–æ–≥–æ —Ä–µ–ø—É—Ç–∞—Ü–∏—è. –í —Å–≤—è–∑–∏ —Å —ç—Ç–∏–º, –æ–ø—è—Ç—å –º–µ–Ω—è–µ–º –∏—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥, —Ä–∞—Å—à–∏—Ä—è—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å OpenSquat —Ä–∞–±–æ—Ç–æ–π —Å API VT (–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –±–µ—Å–ø–ª–∞—Ç–Ω–æ–π –≤–µ—Ä—Å–∏–∏: 4 –∑–∞–ø—Ä–æ—Å–∞ –≤ –º–∏–Ω—É—Ç—É –∏ –Ω–µ –±–æ–ª–µ–µ 500 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –¥–µ–Ω—å).

–ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏:
```markdown
self.URL = "https://www.virustotal.com/api/v3/domains/" + self.domain

headers = {
"X-Apikey": "$APIKEY"
}

malicious = (
self.content
['data']
['attributes']
['last_analysis_stats']
['malicious'] )
```
–ì–æ—Ç–æ–≤–æ, –≤—ã –≤–æ—Å—Ö–∏—Ç–∏—Ç–µ–ª—å–Ω—ã üòä
 
–ü–æ—Å–ª–µ–¥–Ω–∏–º —ç—Ç–∞–ø–æ–º –ø–ª–∞–Ω–∏—Ä—É–µ–º –≤ cron –µ–∂–µ–¥–Ω–µ–≤–Ω—É—é –∑–∞–¥–∞—á—É –Ω–∞ –∑–∞–ø—É—Å–∫ —Å–∫—Ä–∏–ø—Ç–∞ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–º —Ä–∞–∑ –≤ –¥–µ–Ω—å results.txt

----
[video]:https://asciinema.org/a/361931
[—Å–∞–π—Ç–∞]:https://feeds.opensquat.com/
[–±–∏—Ç]:https://habr.com/ru/post/125821/
[—Ç–∞–π–ø]:https://www.kaspersky.ru/resource-center/definitions/what-is-typosquatting
[—Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è –õ–µ–≤–µ–Ω—à—Ç–µ–π–Ω–∞]:https://habr.com/ru/post/676858/
[—Å—Ö–æ–¥—Å—Ç–≤–æ –î–∂–∞—Ä–æ-–í–∏–Ω–∫–ª–µ—Ä–∞]:https://ru.wikipedia.org/wiki/%D0%A1%D1%85%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE_%D0%94%D0%B6%D0%B0%D1%80%D0%BE_%E2%80%94_%D0%92%D0%B8%D0%BD%D0%BA%D0%BB%D0%B5%D1%80%D0%B0