---
layout: default
title: SIGMA 2.0
parent: Cyber Threat Intelligence
nav_order: 13
---
# SIGMA 2.0

What: #sigma\
Where: #vscode\
Who: humpalum\
When: 15/03/2022\
How: via extension
{: .fs-3 .ls-10 .text-mono .code-example }

–î—Ä—É–∑—å—è, –∑–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ!

–¢—Ä–µ—Ç–∏–π –ø–æ—Å—Ç –ø—Ä–æ SIGMA –±—É–¥–µ—Ç –ø–æ—Å–≤—è—â—ë–Ω –æ–±–Ω–æ–≤–ª–µ–Ω–∏—é —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è —ç—Ç–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞. –ù–∞ —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ –±—ã–ª–æ –º–Ω–æ–≥–æ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –Ω–æ–≤–æ—Å—Ç–µ–π –∏ –ø—É–±–ª–∏–∫–∞—Ü–∏–π –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤, –Ω–æ –≤–æ—Ç –ø—Ä–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–∞–ª–æ–≤–∞—Ç–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏. –ò—Å–ø—Ä–∞–≤–ª—è–µ–º ü§ì

–ü–æ—Å–ª–µ –ø—Ä–æ—á—Ç–µ–Ω–∏—è –≤—Å–µ—Ö —Å—Ç–∞—Ç–µ–π –≤—ã–¥–µ–ª–∏–ª –¥–ª—è —Å–µ–±—è –¥–≤–∞ –≥–ª–∞–≤–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏—è:\
1Ô∏è‚É£ —Ç–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –ø–∏—Å–∞—Ç—å –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞ –Ω–∞ SIGMA;\
2Ô∏è‚É£ –ø–æ—è–≤–∏–ª–∞—Å—å –±–û–ª—å—à–∞—è —Å–≤—è–∑–Ω–æ—Å—Ç—å –º–µ–∂–¥—É –ø—Ä–∞–≤–∏–ª–∞–º–∏ –∑–∞ —Å—á—ë—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–Ω–æ–≥–æ –∞—Ç—Ä–∏–±—É—Ç–∞ filter. –ï—Å–ª–∏ –≤—Å–µ –ø—Ä–∏–≤—ã–∫–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∞—Ç—Ä–∏–±—É—Ç filter —Ç–æ–ª—å–∫–æ –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –≤ –±–ª–æ–∫–µ condition –Ω–∞–ø–∏—Å–∞—Ç—å selection and not filter, —Ç–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—É—é –ø–∞–ø–∫—É —Å –∏—Å–∫–ª—é—á–µ–Ω–∏—è–º–∏ –∏ —Å–ª–µ–¥–∏—Ç—å –∑–∞ –Ω–∏–º–∏, –¥–æ–±–∞–≤–ª—è—è –ø—Ä–∞–≤–∏–ª–∞. [–ü–æ–¥—Ä–æ–±–Ω–µ–µ] –ø—Ä–æ —Ñ–∏–ª—å—Ç—Ä—ã. –°–≤—è–∑–Ω–æ—Å—Ç—å —Ç–∞–∫–∂–µ –º–æ–∂–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –∑–∞ —Å—á—ë—Ç –∞—Ç—Ä–∏–±—É—Ç–∞ related ([–ø—Ä–∏–º–µ—Ä]).

–ß—Ç–æ –Ω–∞—Å—á—ë—Ç –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏? –¢–µ–ø–µ—Ä—å –ø–æ—è–≤–∏–ª–∞—Å—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ–ø–∏—Å–∞—Ç—å –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—É—é –ª–æ–≥–∏–∫—É —Å –ø–æ–º–æ—â—å—é SIGMA. –ü—Ä–∏–º–µ—Ä:\
‚ûñ –Ω–µ—Å–∫–æ–ª—å–∫–æ –Ω–µ—É–¥–∞—á–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π –Ω–∞ –æ–¥–Ω–æ–º —Ö–æ—Å—Ç–µ;\
‚ûñ –Ω–µ—É–¥–∞—á–Ω–æ–µ —Å–æ–±—ã—Ç–∏–µ –Ω–∞ –æ–¥–Ω–æ–º —Ö–æ—Å—Ç–µ, –Ω–æ —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤;\
‚ûñ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–æ–±—ã—Ç–∏–π –ø—Ä–æ–∏–∑–æ—à–ª–∏ –≤ –∑–∞–¥–∞–Ω–Ω—ã–π –≤—Ä–µ–º–µ–Ω–Ω–æ–π –∏–Ω—Ç–µ—Ä–≤–∞–ª.

–ü—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç –∏–∑ —Å–µ–±—è —Å–æ–≤—Å–µ–º –æ—Ç–¥–µ–ª—å–Ω—ã–π —Ñ–∞–π–ª–∏–∫ —Å –±–ª–æ–∫–æ–º correlation, –≤–∏–¥–∞:
~~~
title: Multiple failed logons for a single user (possible brute force attack)
status: test
correlation:
    type: event_count
    rules:
        - failed_logon
    group-by:
        - TargetUserName
        - TargetDomainName
    timespan: 5m
    condition:
        gte: 10
~~~
–≥–¥–µ –≤ –±–ª–æ–∫–µ rules –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω—ã –ø—Ä–∞–≤–∏–ª–∞, —É—á–∞—Å—Ç–≤—É—é—â–∏–µ –≤ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏.

–ë–æ–ª–µ–µ –ø–æ–¥—Ä–æ–±–Ω–æ –ø—Ä–æ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—é –º–æ–∂–Ω–æ –ø–æ—á–∏—Ç–∞—Ç—å —É —Å–∞–º–∏—Ö —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –ø—Ä–æ–µ–∫—Ç–∞ –≤ –∏—Ö [–±–ª–æ–≥–µ] —Ç—É—Ç –∏ –Ω–∞ [–≥–∏—Ç—Ö–∞–±–µ].

–í –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–º –ø–æ—Å—Ç–µ —Ç–∞–∫–∂–µ [–∑–∞—è–≤–ª–µ–Ω–æ], —á—Ç–æ —Å –ø—Ä–∏—Ö–æ–¥–æ–º –≤—Ç–æ—Ä–æ–π –≤–µ—Ä—Å–∏–∏ –ø–æ—è–≤–∏–ª–∏—Å—å –Ω–æ–≤—ã–µ –º–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã –¥–ª—è —Ä–∞–∑–ª–∏—á–Ω–æ–≥–æ —Ç–∏–ø–∞ –ø–æ–ª–µ–π, –Ω–æ –∫–∞–∫ –±—É–¥—Ç–æ –±—ã –æ–Ω–∏ –ø–æ—è–≤–∏–ª–∏—Å—å —É–∂–µ –≤ [–Ω–∞—á–∞–ª–µ] —ç—Ç–æ–≥–æ –≥–æ–¥–∞. –ö—Å—Ç–∞—Ç–∏, —É –∫–æ–ª–ª–µ–≥ —Ä–µ–ª–∏–∑ –≤–µ—Ä—Å–∏–∏ 2.0.0 –ø–æ–ª—É—á–∏–ª—Å—è –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞—Å—Ç—è–Ω—É—Ç—ã–º –Ω–∞ –≤–µ—Å—å 2024, –Ω—É –∏–ª–∏ –ø—Ä–æ—Å—Ç–æ —Å –º–∏–Ω–æ—Ä–Ω–æ–π –≤–µ—Ä—Å–∏–æ–Ω–Ω–æ—Å—Ç—å—é –Ω–µ —Å—Ç–∞–ª–∏ –∑–∞–º–æ—Ä–∞—á–∏–≤–∞—Ç—å—Å—è. 

–ê –µ—â—ë –∫–æ–ª–ª–µ–≥–∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é [–æ—Ç–∫–∞–∑–∞–ª–∏—Å—å] –æ—Ç Rx-—Å—Ö–µ–º—ã —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ø—Ä–∞–≤–∏–ª –∏ –ø–µ—Ä–µ—à–ª–∏ –Ω–∞ JSON. –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ —É–≤–µ—Ä–µ–Ω, —á—Ç–æ –≤—Å—ë –¥–µ–ª–æ –≤ —É–¥–æ–±—Å—Ç–≤–µ —Å–æ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏—è.

–ò—Ç–æ–≥–æ–≤–∞—è –æ–±–Ω–æ–≤–ª—ë–Ω–Ω–∞—è —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è [—Ç—É—Ç], –∞ –¥–∏—Ñ—Ñ –≤–µ—Ä—Å–∏–π –º–æ–∂–Ω–æ –ø–æ—á–∏—Ç–∞—Ç—å [–∑–¥–µ—Å—å].

–ü–æ–Ω—è—Ç–Ω–æ, —á—Ç–æ –≤—Ä—É—á–Ω—É—é –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –≤—Å—é —ç—Ç—É —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –æ—á–µ–Ω—å —Å–ª–æ–∂–Ω–æ. –ù–∞ –ø–æ–º–æ—â—å —Ä–∞–∑—É–º–µ–µ—Ç—Å—è –ø—Ä–∏—Ö–æ–¥–∏—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ [pySigma], –∞ –µ—â—ë –∂–¥—ë–º, –∫–æ–≥–¥–∞ humpalum –≤—ã–ø—É—Å—Ç–∏—Ç –æ—á–µ—Ä–µ–¥–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–≤–æ–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –¥–ª—è VS Code, –∞ —Ç–æ —Å 24 —è–Ω–≤–∞—Ä—è —Ç–∏—à–∏–Ω–∞.

–ö—Ä–∞—Å–∏–≤—ã—Ö –≤–∞–º –ø—Ä–∞–≤–∏–ª! 

–í—Å–µ–º —Ö–æ—Ä–æ—à–∏—Ö –≤—ã—Ö–æ–¥–Ω—ã—Ö –∏ –±–µ—Ä–µ–≥–∏—Ç–µ —Å–µ–±—è  üëå

----
[–ø—Ä–∏–º–µ—Ä]:https://github.com/SigmaHQ/sigma/blob/master/rules/windows/registry/registry_set/registry_set_windows_defender_tamper.yml
[–±–ª–æ–≥–µ]:https://blog.sigmahq.io/introducing-sigma-correlations-52fe377f2527
[–≥–∏—Ç—Ö–∞–±–µ]:https://github.com/SigmaHQ/sigma-specification/blob/main/specification/sigma-correlation-rules-specification.md
[–∑–∞—è–≤–ª–µ–Ω–æ]:https://blog.sigmahq.io/introducing-sigma-specification-v2-0-25f81a926ff0

[–ü–æ–¥—Ä–æ–±–Ω–µ–µ]:https://blog.sigmahq.io/introducing-sigma-filters-204bd8496273
[–ø—Ä–∏–º–µ—Ä]:https://github.com/SigmaHQ/sigma/blob/master/rules/windows/registry/registry_set/registry_set_windows_defender_tamper.yml
[–±–ª–æ–≥–µ]:https://blog.sigmahq.io/introducing-sigma-correlations-52fe377f2527
[–≥–∏—Ç—Ö–∞–±–µ]:https://github.com/SigmaHQ/sigma-specification/blob/main/specification/sigma-correlation-rules-specification.md
[–∑–∞—è–≤–ª–µ–Ω–æ]:https://blog.sigmahq.io/introducing-sigma-specification-v2-0-25f81a926ff0
[–Ω–∞—á–∞–ª–µ]:https://github.com/SigmaHQ/sigma-specification/blob/ebc2f178cf8a280f08200f438cf852753d784dd7/appendix/appendix_modifier.md
[–æ—Ç–∫–∞–∑–∞–ª–∏—Å—å]:https://github.com/SigmaHQ/sigma-specification/tree/main/json-schema
[—Ç—É—Ç]:https://github.com/SigmaHQ/sigma-specification/blob/main/specification/sigma-rules-specification.md
[–∑–¥–µ—Å—å]:https://github.com/SigmaHQ/sigma-specification/blob/main/other/version-2-changes.md
[pySigma]:https://github.com/SigmaHQ/pySigma